stages:
  - build
  - Security
  # - dockerbuild

build:
  stage: build
  image: node:18.9.1
  script:
    - cd mern/backend
    - npm install
  artifacts:
    paths:
      - mern/backend/node_modules


trivy-fs-scan:
  stage: Security
  script:
    - apt-get update && apt-get install -y wget
    - wget https://github.com/aquasecurity/trivy/releases/download/v0.42.0/trivy_0.42.0_Linux-64bit.deb
    - dpkg -i trivy_0.42.0_Linux-64bit.deb
    - trivy --version
    - cd mern/backend
    - trivy fs --format table -o trivyfs.html .
  artifacts:
    paths:
      - trivyfs.html

      
# build-Docker:
#   stage: dockerbuild
#   script:
#     - docker login -u $username -p $password 
#     - cd mern/backend
#     - docker buld -t prasannakumarsinganamalla431 -f 
#   dependencies:
#     - build  
 